# ===========================================
# 需求自动化管理系统 - 环境变量配置模板
# 复制此文件为 .env 并填入实际值
# ===========================================

# -------------------------------------------
# 服务端口配置
# 用途：各微服务监听的端口号
# 获取方式：使用默认值即可，如有端口冲突可自行修改
# -------------------------------------------

# TAPD 服务端口
TAPD_SERVICE_PORT=3401

# AI 服务端口
AI_SERVICE_PORT=3402

# 终端服务端口
TERMINAL_SERVICE_PORT=3403

# -------------------------------------------
# TAPD 配置 (必需)
# 用途：连接腾讯 TAPD 敏捷项目管理平台
# 官网：https://www.tapd.cn
# -------------------------------------------

# TAPD API 基础地址（一般不需要修改）
TAPD_API_BASE=https://api.tapd.cn

# TAPD 项目空间 ID
# 获取方式：登录 TAPD -> 进入项目 -> URL 中的数字即为 workspace_id
# 示例：https://www.tapd.cn/12345678/... 中的 12345678
TAPD_WORKSPACE_ID=

# TAPD API Token（推荐方式）
# 获取方式：TAPD -> 公司管理 -> 应用管理 -> 创建应用 -> 获取 API Token
# 文档：https://www.tapd.cn/help/view#1120003271001001349
TAPD_TOKEN=

# TAPD 用户名密码认证（备用方式，不推荐）
# 获取方式：使用登录 TAPD 的用户名和密码
# 注意：如果配置了 TAPD_TOKEN，这两项可留空
TAPD_USERNAME=
TAPD_PASSWORD=

# TAPD 自定义字段映射
# 用途：映射 TAPD 中的自定义字段到系统字段
# 获取方式：TAPD -> 项目设置 -> 需求设置 -> 自定义字段 -> 查看字段 key

# 前端工时字段名（逗号分隔多个候选，按优先级排序）
TAPD_FE_HOURS_KEYS=custom_field_six,前端工时,fe_hours

# 前端负责人字段
TAPD_FRONTEND_FIELD_KEYS=custom_field_four

# 需求负责人快捷筛选（JSON 数组格式）
# 用途：在筛选器中快速选择指定负责人
# 配置方式：填入团队成员姓名
STORY_OWNER_QUICK_TOKENS=["张三","李四","王五"]

# -------------------------------------------
# Notion 配置 (可选)
# 用途：将需求/缺陷同步到 Notion 数据库
# 官网：https://www.notion.so
# -------------------------------------------

# Notion Integration Token
# 获取方式：
#   1. 访问 https://www.notion.so/my-integrations
#   2. 创建新 Integration
#   3. 复制 Internal Integration Token
#   4. 在目标数据库页面点击右上角 ... -> 连接 -> 选择刚创建的 Integration
NOTION_TOKEN=

# Notion 主数据库 ID（可选）
# 获取方式：打开数据库页面，URL 中 notion.so/ 后、? 前的 32 位字符串
# 示例：https://www.notion.so/myspace/abc123...?v=xxx 中的 abc123...
NOTION_DATABASE_ID=

# Notion 需求数据库 ID
# 用途：存储从 TAPD 同步的需求数据
NOTION_REQUIREMENT_DB_ID=

# Notion 缺陷数据库 ID
# 用途：存储从 TAPD 同步的缺陷数据
NOTION_DEFECT_DB_ID=

# Notion 属性名映射
# 用途：映射 Notion 数据库中的属性名
# 配置方式：确保与 Notion 数据库中的列名一致
NOTION_FE_HOURS_PROP=前端工时
NOTION_STATUS_PROP=需求状态

# -------------------------------------------
# AI 服务配置
# 用途：提供需求分析、智能建议等 AI 功能
# -------------------------------------------

# AI 提供商选择
# 可选值：ollama（本地部署）、deepseek（云端 API）
# 推荐：开发环境用 ollama，生产环境用 deepseek
AI_PROVIDER=ollama

# ---- Ollama 配置 ----
# 用途：使用本地部署的 Ollama 大模型
# 安装：https://ollama.ai
# 启动：ollama serve && ollama pull qwen2.5:7b

# Ollama 服务地址
OLLAMA_BASE_URL=http://localhost:11434

# 使用的模型名称
# 可选模型：qwen2.5:7b, llama2, mistral 等
# 查看已安装模型：ollama list
OLLAMA_MODEL=qwen2.5:7b

# 请求超时时间（毫秒）
OLLAMA_TIMEOUT=120000

# ---- DeepSeek 配置 ----
# 用途：使用 DeepSeek 云端 API（需付费）
# 官网：https://platform.deepseek.com

# DeepSeek API Key
# 获取方式：https://platform.deepseek.com/api_keys
DEEPSEEK_API_KEY=

# DeepSeek API 地址（一般不需要修改）
DEEPSEEK_BASE_URL=https://api.deepseek.com

# 使用的模型名称
# 可选值：deepseek-chat, deepseek-coder
DEEPSEEK_MODEL=deepseek-chat

# 请求超时时间（毫秒）
DEEPSEEK_TIMEOUT=120000

# 是否启用 LLM 需求分析功能
# 可选值：0（禁用）、1（启用）
# 注意：启用后会消耗 AI 服务资源
ANALYSIS_USE_LLM=0

# -------------------------------------------
# 终端服务配置
# 用途：提供内置终端功能
# -------------------------------------------

# 终端日志存储目录
# 用途：保存终端会话日志
# 默认值：./logs/terminal
TERMINAL_LOG_DIR=./logs/terminal

# -------------------------------------------
# 任务队列配置 (可选)
# 用途：控制后台任务执行
# -------------------------------------------

# 最大并发任务数
# 建议：根据机器性能调整，一般 2-4
JOB_MAX_CONCURRENT=2

# 队列最大长度
# 超出后新任务将被拒绝
JOB_QUEUE_LIMIT=50

# 已完成任务保留时间（秒）
# 用于查看历史任务状态
JOB_RETENTION_SECONDS=3600

# -------------------------------------------
# 缓存配置 (可选)
# 用途：减少 API 请求，提升响应速度
# -------------------------------------------

# 需求数据缓存时间（秒）
# 建议：120-300，太短增加 API 压力，太长数据不够实时
TAPD_STORY_CACHE_TTL=120

# 迭代数据缓存时间（秒）
# 迭代数据变化较少，可设置较长
TAPD_ITERATION_CACHE_TTL=300
